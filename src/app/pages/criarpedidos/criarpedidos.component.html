<div class="create-dish-container">
  <h2>Cadastrar Novo Prato</h2>

  <!-- Mensagem de erro -->
  <div *ngIf="errorMessage" class="error-message">
    {{ errorMessage }}
  </div>

  <!-- Mensagem de sucesso -->
  <div *ngIf="successMessage" class="success-message">
    {{ successMessage }}
  </div>

  <form [formGroup]="form" (ngSubmit)="save()" class="dish-form">
    
    <!-- Nome -->
    <div class="form-group">
      <label for="name">Nome do Prato *</label>
      <input 
        type="text" 
        id="name" 
        formControlName="name"
        placeholder="Ex: Pizza Margherita"
        [class.error]="hasError('name', 'required') || hasError('name', 'minlength')">
      
      <div *ngIf="hasError('name', 'required')" class="field-error">
        Nome √© obrigat√≥rio
      </div>
      <div *ngIf="hasError('name', 'minlength')" class="field-error">
        Nome deve ter pelo menos 2 caracteres
      </div>
    </div>

    <!-- Descri√ß√£o -->
    <div class="form-group">
      <label for="description">Descri√ß√£o *</label>
      <textarea 
        id="description" 
        formControlName="description"
        placeholder="Descreva o prato..."
        rows="3"
        [class.error]="hasError('description', 'required') || hasError('description', 'minlength')"></textarea>
      
      <div *ngIf="hasError('description', 'required')" class="field-error">
        Descri√ß√£o √© obrigat√≥ria
      </div>
      <div *ngIf="hasError('description', 'minlength')" class="field-error">
        Descri√ß√£o deve ter pelo menos 5 caracteres
      </div>
    </div>

    <!-- Pre√ßo -->
    <div class="form-group">
      <label for="price">Pre√ßo (R$) *</label>
      <input 
        type="number" 
        id="price" 
        formControlName="price"
        min="0.01"
        max="1000"
        step="0.01"
        placeholder="0.00"
        [class.error]="hasError('price', 'required') || hasError('price', 'min')">
      
      <div *ngIf="hasError('price', 'required')" class="field-error">
        Pre√ßo √© obrigat√≥rio
      </div>
      <div *ngIf="hasError('price', 'min')" class="field-error">
        Pre√ßo deve ser maior que R$ 0,00
      </div>
    </div>

    <!-- A√ß√µes -->
    <div class="form-actions">
      
      <button 
        type="button" 
        class="btn btn-clear"
        (click)="resetForm()"
        [disabled]="loading">
        üßπ Limpar
      </button>
      
      <!-- BOT√ÉO EXCLUIR PRATO (sempre vis√≠vel) -->
      <button 
        type="button" 
        class="btn btn-danger"
        (click)="openDeleteDialog()"
        [disabled]="loading">
        üóëÔ∏è Excluir Prato
      </button>
      
      <button 
        type="submit" 
        class="btn btn-primary"
        [disabled]="loading || form.invalid">
        {{ loading ? '‚è≥ Salvando...' : 'üíæ Salvar Prato' }}
      </button>
    </div>

  </form>

  <!-- Modal/Dialog para selecionar prato a excluir -->
  <div *ngIf="showDeleteDialog" class="modal-overlay">
    <div class="modal-content">
      <h3>Selecionar Prato para Excluir</h3>
      
      <div *ngIf="loadingProducts" class="loading">
        Carregando pratos...
      </div>
      
      <div *ngIf="products.length === 0 && !loadingProducts" class="no-products">
        Nenhum prato cadastrado.
      </div>
      
      <div class="products-list" *ngIf="products.length > 0">
        <div 
          *ngFor="let product of products" 
          class="product-item"
          [class.selected]="selectedProductId === product.id"
          (click)="selectProduct(product.id)">
          <div class="product-info">
            <strong>{{ product.name }}</strong>
            <p>{{ product.description }}</p>
            <small>Pre√ßo: R$ {{ product.price }}</small>
          </div>
        </div>
      </div>
      
      <div class="modal-actions">
        <button 
          type="button" 
          class="btn btn-secondary"
          (click)="closeDeleteDialog()">
          Cancelar
        </button>
        
        <button 
          type="button" 
          class="btn btn-danger"
          (click)="confirmDelete()"
          [disabled]="!selectedProductId">
          Confirmar Exclus√£o
        </button>
      </div>
    </div>
  </div>

</div>